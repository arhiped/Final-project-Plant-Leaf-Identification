# Идентификация листьев растения

Идентификация растений по листьям растений на основе их формы, цвета и текстурных особенностей с использованием методов цифровой обработки изображений.

## Обзор

Идентификация листьев растений - это система, которая способна классифицировать ** 32 различных вида растений ** на основе их листьев с использованием методов цифровой обработки изображений. Изображения сначала подвергаются предварительной обработке, а затем из обработанного изображения извлекаются элементы, основанные на их форме, цвете и текстуре.

Набор данных был создан с использованием извлеченных объектов для обучения и тестирования модели. Используемая модель была ** Машинным классификатором опорных векторов ** и была способна классифицировать с ** точностью 90,05% **.

## Набор данных

Используемый набор данных - [**Набор данных листьев Флавии**](http://flavia.sourceforge.net ), который также содержит точки останова и имена, упомянутые для набора данных leaves

## Зависимости

* [Numpy](http://www.numpy.org)
* [Pandas](https://pandas.pydata.org)
* [OpenCV](https://opencv.org)
* [Matplotlib](https://matplotlib.org)
* [Scikit Learn](http://scikit-learn.org/)
* [Mahotas](http://mahotas.readthedocs.io/en/latest/)

## Инструкции

* Создайте следующие папки в корне проекта - 
  * `Набор данных Flavia leaves dataset`: будет содержать набор данных Flavia
  * "мобильные снимки": будут содержать изображения листьев, снятые с мобильных устройств, для дополнительных целей тестирования

## Структура проекта

* [файл single_image_process_file.ipynb](файл single_image_process_file.ipynb) : содержит исследование методов предварительной обработки и извлечения объектов путем работы с одним изображением.
* [background_subtract_camera_capture_leaf_file.ipynb](background_subtract_camera_capture_leaf_file.ipynb) : содержит описание методов создания функции вычитания фона для удаления фона с изображений листьев, снятых мобильной камерой.
* [classify_leaves_flavia.ipynb](Flavia%20py%20files/classify_leaves_flavia.ipynb) : использует извлеченные объекты в качестве входных данных для модели и классифицирует их с помощью классификатора SVM.
* [preprocess_extract_dataset_flavia.ipynb](Flavia%20py%20files/preprocess_extract_dataset_flavia.ipynb ) : содержит функцию create_dataset(), которая выполняет предварительную обработку изображения и извлечение объектов из набора данных. Набор данных хранится в файле `Flavia_features.csv`

## Методология

### 1. Предварительная обработка

Для предварительной обработки изображения были выполнены следующие шаги:

  1. Преобразование изображения RGB в оттенки серого
  2. Сглаживание изображения с помощью фильтра Гаусса
  3. Адаптивное пороговое значение изображения с использованием метода порогового значения Otsu
  4. Закрытие отверстий с использованием морфологического преобразования
  5. Выделение границ с использованием контуров

### 2. Извлечение признаков

Из предварительно обработанного изображения были извлечены различные типы элементов листа, которые перечислены следующим образом:

  1. *Характеристики, основанные на форме*: физиологическая длина, физиологическая ширина, площадь, периметр, соотношение сторон, прямоугольность, округлость
  2. *Характеристики, основанные на цвете*: среднее значение и стандартные отклонения каналов RGB.
  3. *Особенности, основанные на текстуре*: контраст, корреляция, моменты обратной разности, энтропия
  
### 3. Построение модели и тестирование

  * Машина опорных векторов классификатора была использована в качестве модели для классификации видов растений <br>
  * Затем объекты были масштабированы с помощью StandardScaler<br>
  * Также была выполнена настройка параметров для поиска соответствующих гиперпараметров модели с использованием GridSearchCV
